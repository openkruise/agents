---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.18.0
  name: sandboxclaims.agents.kruise.io
spec:
  group: agents.kruise.io
  names:
    kind: SandboxClaim
    listKind: SandboxClaimList
    plural: sandboxclaims
    shortNames:
    - sbc
    singular: sandboxclaim
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .spec.templateName
      name: Template
      type: string
    - jsonPath: .spec.replicas
      name: Desired
      type: integer
    - jsonPath: .status.claimedReplicas
      name: Claimed
      type: integer
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: SandboxClaim is the Schema for the sandboxclaims API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: spec defines the desired state of SandboxClaim
            properties:
              annotations:
                additionalProperties:
                  type: string
                description: |-
                  Annotations contains key-value pairs to be added as annotations
                  to claimed Sandbox resources
                type: object
              claimTimeout:
                default: 1m
                description: |-
                  ClaimTimeout specifies the maximum duration to wait for claiming sandboxes
                  If the timeout is reached, the claim will be marked as Completed regardless of
                  whether all replicas were successfully claimed
                type: string
              envVars:
                additionalProperties:
                  type: string
                description: |-
                  EnvVars contains environment variables to be injected into the sandbox
                  These will be passed to the sandbox's init endpoint (envd) after claiming
                  Only applicable if the SandboxSet has envd enabled
                type: object
              labels:
                additionalProperties:
                  type: string
                description: |-
                  Labels contains key-value pairs to be added as labels
                  to claimed Sandbox resources
                type: object
              replicas:
                default: 1
                description: |-
                  Replicas specifies how many sandboxes to claim (default: 1)
                  For batch claiming support
                  This field is immutable once set
                format: int32
                minimum: 1
                type: integer
                x-kubernetes-validations:
                - message: replicas is immutable
                  rule: self == oldSelf
              shutdownTime:
                description: |-
                  ShutdownTime specifies the absolute time when the sandbox should be shut down
                  This will be set as spec.shutdownTime (absolute time) on the Sandbox
                format: date-time
                type: string
              templateName:
                description: TemplateName specifies which SandboxSet pool to claim
                  from
                type: string
              ttlAfterCompleted:
                default: 5m
                description: |-
                  TTLAfterCompleted specifies the time to live after the claim reaches Completed phase
                  After this duration, the SandboxClaim will be automatically deleted.
                  Note: Only the SandboxClaim resource will be deleted; the claimed sandboxes will NOT be deleted
                type: string
            required:
            - templateName
            type: object
          status:
            description: status defines the observed state of SandboxClaim
            properties:
              claimStartTime:
                description: |-
                  ClaimStartTime is the timestamp when claiming started
                  Used for calculating timeout
                format: date-time
                type: string
              claimedReplicas:
                description: |-
                  ClaimedReplicas indicates how many sandboxes are currently claimed (total)
                  This is determined by querying sandboxes with matching ownerReference
                  Only updated during Pending and Claiming phases
                format: int32
                type: integer
              completionTime:
                description: |-
                  CompletionTime is the timestamp when the claim reached Completed phase
                  Used for TTL calculation
                format: date-time
                type: string
              conditions:
                description: Conditions represent the current state of the SandboxClaim
                items:
                  description: Condition contains details for one aspect of the current
                    state of this API Resource.
                  properties:
                    lastTransitionTime:
                      description: |-
                        lastTransitionTime is the last time the condition transitioned from one status to another.
                        This should be when the underlying condition changed.  If that is not known, then using the time when the API field changed is acceptable.
                      format: date-time
                      type: string
                    message:
                      description: |-
                        message is a human readable message indicating details about the transition.
                        This may be an empty string.
                      maxLength: 32768
                      type: string
                    observedGeneration:
                      description: |-
                        observedGeneration represents the .metadata.generation that the condition was set based upon.
                        For instance, if .metadata.generation is currently 12, but the .status.conditions[x].observedGeneration is 9, the condition is out of date
                        with respect to the current state of the instance.
                      format: int64
                      minimum: 0
                      type: integer
                    reason:
                      description: |-
                        reason contains a programmatic identifier indicating the reason for the condition's last transition.
                        Producers of specific condition types may define expected values and meanings for this field,
                        and whether the values are considered a guaranteed API.
                        The value should be a CamelCase string.
                        This field may not be empty.
                      maxLength: 1024
                      minLength: 1
                      pattern: ^[A-Za-z]([A-Za-z0-9_,:]*[A-Za-z0-9_])?$
                      type: string
                    status:
                      description: status of the condition, one of True, False, Unknown.
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: type of condition in CamelCase or in foo.example.com/CamelCase.
                      maxLength: 316
                      pattern: ^([a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*/)?(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])$
                      type: string
                  required:
                  - lastTransitionTime
                  - message
                  - reason
                  - status
                  - type
                  type: object
                type: array
                x-kubernetes-list-map-keys:
                - type
                x-kubernetes-list-type: map
              message:
                description: Message provides human-readable details about the current
                  phase
                type: string
              observedGeneration:
                description: ObservedGeneration is the most recent generation observed
                format: int64
                type: integer
              phase:
                description: |-
                  Phase represents the current phase of the claim
                  Claiming: In the process of claiming sandboxes
                  Completed: Claim process finished (either all replicas claimed or timeout reached)
                type: string
            type: object
        required:
        - spec
        type: object
    served: true
    storage: true
    subresources:
      status: {}
